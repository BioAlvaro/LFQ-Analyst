---
title: "MBPF Label Free Quantitive (LFQ) Proteomics Analysis Plots"
#author: "Anup Shah"
date: "`r format(Sys.time(), '%d %B, %Y')`"
params:
  tested_contrasts: NA
  numbers_input: NA
  coverage_input: NA
  pca_input: NA
  correlation_input: NA
  missval_input: NA
  detect_input: NA
  imputation_input: NA
  heatmap_input: NA
  dep: NA
  pg_width: NA
  cvs_input: NA
output: 
  pdf_document:
    fig_caption: yes
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(opts.label="kill_prefix") # Remove line number and Comment "##" from printing
```

### Proteomics Experiment Summary

Protein identifications per sample.



```{r numbers, echo=FALSE, warning=FALSE }
#str(data_filter)
print(params$numbers_input())
#plot_numbers(params$data_filter)
```
\pagebreak

Protein overlap in all samples.


```{r coverage, echo=FALSE, warning=FALSE}
print(params$coverage_input())
```


\pagebreak

## Exploratory Analysis

#### Principle Component Analysis (PCA) plot

```{r, echo=FALSE}
num = 400
#if (nrow(params$dep) < 400) num = nrow(params$dep)
```


```{r pca_plot, echo=FALSE, fig.height= 4}
print(params$pca_input())
```


#### Sample Correlation matrix

```{r correlation_heatmap, echo=FALSE,   fig.height= 4}
print(params$correlation_input())
```


#### Sample Coefficient of variation (CVs)

```{r sample_cv,  echo=FALSE, warning=FALSE }
print(params$cvs_input())
```
\pagebreak

## Missing Value handling

#### Missing value heatmap
A heatmap for proteins with missing value in each dataset. Each row represent a protein with missing value in one or more replicate. Each replicate is clustered based on presence of missing values in the sample. 


```{r missing_value_heatmap, echo=FALSE, message=FALSE, warning=FALSE, tidy=TRUE}
print(params$missval_input())
```
\pagebreak

### Missing value distribution
What are the intensities for proteins with and without missing values in the dataset?

```{r missing_value_distribution, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
print(params$detect_input())
```
\pagebreak

### Protein expression distribution before and after imputation
Effect of imputation on protein expression distribution

```{r imputation_effect, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
print(params$imputation_input())
```
\pagebreak

## Differential Expression Analysis

#### Heatmap
  A plot representing an overview of expression of all significant(differencially expressed) proteins (rows) in all samples (columns).

 
```{r heatmap_2,  echo=FALSE, warning=FALSE, results='hide'}
print(params$heatmap_input())
```

#### Volcano Plots

```{r volcano,  echo=FALSE, fig.cap='volcano plots for analysis', warning=FALSE, comment=NA}
for(i in params$tested_contrasts){
  print(paste0('volcano_plot_',i,sep=""))
  print(plot_volcano(params$dep(),contrast = i,label_size = 2, add_names = T))
  }
```





